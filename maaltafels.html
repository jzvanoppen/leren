<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Maaltafels — Oefenen</title>
  <style>
    :root{
      --bg:#f6fafc;
      --card:#ffffff;
      --accent:#0b6e4f;
      --muted:#6b7280;
      --success:#16a34a;
      --danger:#ef4444;
      --glass: rgba(11,110,79,0.08);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:linear-gradient(180deg,var(--bg),#eaf7ee 60%);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:32px;
    }
    .wrap{
      width:100%;
      max-width:820px;
    }
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      margin-bottom:18px;
    }
    h1{margin:0;font-size:1.4rem; color:var(--accent)}
    p.lead{margin:0;color:var(--muted)}
    .card{
      background:var(--card);
      border-radius:12px;
      padding:20px;
      box-shadow:0 8px 24px rgba(11,110,79,0.06);
    }
    .controls{
      display:flex;
      gap:12px;
      align-items:center;
      margin-bottom:14px;
      flex-wrap:wrap;
    }
    label.small{font-size:0.9rem;color:var(--muted)}
    .btn{
      background:var(--accent);
      color:white;
      border:none;
      padding:10px 14px;
      border-radius:10px;
      cursor:pointer;
      font-weight:600;
    }
    .btn.secondary{
      background:transparent;
      border:1px solid #d1d5db;
      color:#111827;
      font-weight:600;
    }
    .problem{
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:center;
      margin:18px 0;
      font-size:1.9rem;
      font-weight:700;
    }
    .input-wrap{display:flex;gap:8px;align-items:center;}
    input[type="number"]{
      font-size:1.1rem;padding:10px;border-radius:8px;border:1px solid #e6eef0;width:120px;text-align:center;
    }
    .feedback{min-height:28px;margin-top:8px;font-weight:600}
    .feedback.ok{color:var(--success)}
    .feedback.wrong{color:var(--danger)}
    .stats{display:flex;gap:12px;flex-wrap:wrap;color:var(--muted);margin-top:10px}
    .meter{
      height:10px;background:#f1f5f9;border-radius:999px;overflow:hidden;width:100%;
    }
    .meter > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#2ea36a);width:0%}
    footer{margin-top:12px;color:var(--muted);font-size:0.9rem;text-align:center}
    .small-muted{font-size:0.9rem;color:var(--muted)}
    @media (max-width:560px){
      .problem{font-size:1.5rem;flex-direction:column}
      input[type="number"]{width:100%}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1 id="title">Maaltafels — Tafel van 2</h1>
        <p class="lead" id="subtitle">Oefen met de tafel van 2. Voer het antwoord in en druk op Controleer of Enter.</p>
      </div>
      <div class="small-muted">Taal: Nederlands</div>
    </header>

    <main class="card" role="main">
      <div class="controls">
        
        <div>
          <label class="small">Kies tafel</label><br>
          <select id="tableSelect" style="padding:6px;border-radius:8px;border:1px solid #e6eef0">
            <option value="2">Tafel van 2</option>
            <option value="10">Tafel van 10</option>
          </select>
        </div>

        <div>
          <label class="small">Aantal vragen (1–50)</label><br>
          <input id="qCount" type="number" min="1" max="50" value="10" style="width:86px;padding:6px;border-radius:8px;border:1px solid #e6eef0">
        </div>

        <div>
          <label class="small">Volgorde</label><br>
          <select id="order" style="padding:6px;border-radius:8px;border:1px solid #e6eef0">
            <option value="random">Willekeurig</option>
            <option value="seq">Opeenvolgend</option>
          </select>
        </div>

        <div style="margin-left:auto;display:flex;gap:8px">
          <button class="btn" id="startBtn">Start</button>
          <button class="btn secondary" id="resetBtn">Reset</button>
        </div>
      </div>

      <div id="exercise" hidden>
        <div class="problem">
          <span id="left">2</span>
          <span>×</span>
          <span id="right">1</span>
          <div class="input-wrap">
            <input id="answer" type="number" inputmode="numeric" autocomplete="off" />
            <button class="btn" id="checkBtn">Controleer</button>
          </div>
        </div>

        <div class="feedback" id="feedback"></div>

        <div class="stats">
          <div>Vraag <strong id="current">0</strong> / <strong id="total">0</strong></div>
          <div>Goed: <strong id="correct">0</strong></div>
          <div>Fout: <strong id="wrong">0</strong></div>
          <div style="flex:1">
            <div class="meter"><i id="meterFill"></i></div>
          </div>
        </div>

        <div style="display:flex;gap:8px;margin-top:14px">
          <button class="btn secondary" id="nextBtn" disabled>Volgende</button>
          <button class="btn secondary" id="showAnswerBtn">Laat antwoord zien</button>
          <button class="btn" id="restartBtn">Opnieuw</button>
        </div>
      </div>

      <div id="endScreen" hidden style="margin-top:10px;text-align:center">
        <h2>Einde — resultaat</h2>
        <p class="small-muted" id="resultSummary"></p>
        <div style="display:flex;gap:8px;justify-content:center;margin-top:10px">
          <button class="btn" id="againBtn">Nog een keer</button>
          <button class="btn secondary" id="downloadBtn">Download vragen (csv)</button>
        </div>
      </div>
    </main>

    <footer>
      Tip: gebruik je toetsenbord — type je antwoord en druk op Enter om te controleren.
    </footer>
  </div>

<script>
(() => {

  let left = 2; // gekozen tafel
  const maxMultiplier = 10;
  let questions = [];
  let idx = 0;
  let total = 10;
  let correct = 0;
  let wrong = 0;
  let state = 'idle';

  const tableSelect = document.getElementById('tableSelect');
  const startBtn = document.getElementById('startBtn');
  const resetBtn = document.getElementById('resetBtn');
  const qCount = document.getElementById('qCount');
  const order = document.getElementById('order');
  const exercise = document.getElementById('exercise');
  const leftEl = document.getElementById('left');
  const rightEl = document.getElementById('right');
  const answerInput = document.getElementById('answer');
  const checkBtn = document.getElementById('checkBtn');
  const feedback = document.getElementById('feedback');
  const currentEl = document.getElementById('current');
  const totalEl = document.getElementById('total');
  const correctEl = document.getElementById('correct');
  const wrongEl = document.getElementById('wrong');
  const nextBtn = document.getElementById('nextBtn');
  const restartBtn = document.getElementById('restartBtn');
  const showAnswerBtn = document.getElementById('showAnswerBtn');
  const endScreen = document.getElementById('endScreen');
  const meterFill = document.getElementById('meterFill');
  const resultSummary = document.getElementById('resultSummary');
  const againBtn = document.getElementById('againBtn');
  const downloadBtn = document.getElementById('downloadBtn');
  const title = document.getElementById('title');
  const subtitle = document.getElementById('subtitle');

  function buildQuestions(count, mode='random'){
    const base = [];
    for(let m=1;m<=maxMultiplier;m++){
      base.push({left, right:m, answer:left*m});
    }
    let arr = [];

    if(mode === 'seq'){
      while(arr.length < count) arr = arr.concat(base);
      arr = arr.slice(0,count);
    } else {
      for(let i=0;i<count;i++){
        const pick = base[Math.floor(Math.random()*base.length)];
        arr.push({...pick});
      }
      shuffle(arr);
    }
    return arr;
  }

  function shuffle(a){
    for(let i=a.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [a[i],a[j]] = [a[j],a[i]];
    }
  }

  function start(){
    left = parseInt(tableSelect.value);
    total = Math.max(1, Math.min(50, parseInt(qCount.value)||10));
    questions = buildQuestions(total, order.value);

    idx = 0; correct = 0; wrong = 0;
    state = 'running';

    exercise.hidden = false;
    endScreen.hidden = true;

    totalEl.textContent = total;
    title.textContent = `Maaltafels — Tafel van ${left}`;
    subtitle.textContent = `Oefen met de tafel van ${left}. Voer het antwoord in en druk op Controleer of Enter.`;

    updateStats();
    presentQuestion();
    answerInput.focus();
  }

  function presentQuestion(){
    const q = questions[idx];
    leftEl.textContent = q.left;
    rightEl.textContent = q.right;

    currentEl.textContent = idx+1;
    feedback.textContent = '';
    answerInput.value = '';
    answerInput.disabled = false;
    checkBtn.disabled = false;
    nextBtn.disabled = true;

    updateMeter();
  }

  function updateStats(){
    correctEl.textContent = correct;
    wrongEl.textContent = wrong;
    updateMeter();
  }

  function updateMeter(){
    const pct = Math.round((idx / total) * 100);
    meterFill.style.width = pct + '%';
  }

  function checkAnswer(){
    if(state !== 'running') return;

    const val = answerInput.value.trim();
    if(val === ''){
      feedback.textContent = 'Vul eerst een antwoord in.';
      feedback.className = 'feedback wrong';
      return;
    }

    const numeric = Number(val);
    const q = questions[idx];

    if(numeric === q.answer){
      feedback.textContent = 'Correct! ✅';
      feedback.className = 'feedback ok';
      correct++;
    } else {
      feedback.textContent = `Fout — het juiste antwoord is ${q.answer}.`;
      feedback.className = 'feedback wrong';
      wrong++;
    }

    answerInput.disabled = true;
    checkBtn.disabled = true;
    nextBtn.disabled = false;
    updateStats();

    if(idx >= total - 1) state = 'finished';
  }

  function nextQuestion(){
    if(idx < total - 1){
      idx++;
      presentQuestion();
      answerInput.focus();
    } else {
      showEnd();
    }
  }

  function showAnswer(){
    const q = questions[idx];
    feedback.textContent = `Antwoord: ${q.answer}`;
    feedback.className = 'feedback ok';
  }

  function showEnd(){
    exercise.hidden = true;
    endScreen.hidden = false;
    resultSummary.textContent = `Je hebt ${correct} van de ${total} vragen goed. (${Math.round((correct/total)*100)}%)`;
  }

  function resetAll(){
    state = 'idle';
    exercise.hidden = true;
    endScreen.hidden = true;
    idx = 0; correct = 0; wrong = 0;

    currentEl.textContent = 0;
    totalEl.textContent = 0;
    correctEl.textContent = 0;
    wrongEl.textContent = 0;

    meterFill.style.width = '0%';
    feedback.textContent = '';

    title.textContent = `Maaltafels — Tafel van ${left}`;
  }

  function restartSame(){
    start();
  }

  function downloadCSV(){
    let csv = 'left,right,answer\n';
    questions.forEach((q)=>{ csv += `${q.left},${q.right},${q.answer}\n`; });

    const blob = new Blob([csv], {type:'text/csv'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `maaltafel_${left}.csv`;
    a.click();
    URL.revokeObjectURL(url);
  }

  startBtn.addEventListener('click', start);
  resetBtn.addEventListener('click', resetAll);
  checkBtn.addEventListener('click', ()=>{ checkAnswer(); });
  nextBtn.addEventListener('click', ()=>{ nextQuestion(); });
  restartBtn.addEventListener('click', restartSame);
  showAnswerBtn.addEventListener('click', showAnswer);
  againBtn.addEventListener('click', ()=>{ resetAll(); start(); });
  downloadBtn.addEventListener('click', downloadCSV);

  answerInput.addEventListener('keydown', (e)=>{
    if(e.key === 'Enter'){
      e.preventDefault();
      checkAnswer();
    }
    if(e.key === 'ArrowRight'){
      e.preventDefault();
      if(!nextBtn.disabled) nextQuestion();
    }
  });

  resetAll();

})();
</script>

</body>
</html>
